const float HS0 = mag_d*q_y;
const float HS1 = mag_d*q_z;
const float HS2 = mag_e*q_y;
const float HS3 = mag_d*q_w;
const float HS4 = mag_e*q_x;
const float HS5 = mag_n*q_y;
const float HS6 = mag_d*q_x;
const float HS7 = mag_e*q_w;
const float HS8 = mag_n*q_z;
const float HS9 = 2*powf(q_y, 2);
const float HS10 = 2*powf(q_z, 2) - 1;
const float HS11 = q_w*q_z;
const float HS12 = q_w*q_y;
const float HS13 = -HS8;
const float HS14 = mag_n*q_x;
const float HS15 = mag_n*q_w;
const float HS16 = mag_e*q_z;
const float HS17 = 2*powf(q_x, 2);
const float HS18 = q_w*q_x;


H_Fusion[0][0] = -2*HS0 + 2*mag_e*q_z;
H_Fusion[1][0] = 2*HS13 + 2*HS6;
H_Fusion[2][0] = -2*HS4 + 2*mag_n*q_y;
H_Fusion[0][1] = 2*HS1 + 2*HS2;
H_Fusion[1][1] = 2*HS3 - 4*HS4 + 2*HS5;
H_Fusion[2][1] = -2*HS13 - 4*HS6 - 2*HS7;
H_Fusion[0][2] = -2*HS3 + 2*HS4 - 4*HS5;
H_Fusion[1][2] = 2*HS1 + 2*HS14;
H_Fusion[2][2] = -4*HS0 + 2*HS15 + 2*HS16;
H_Fusion[0][3] = 2*HS6 + 2*HS7 - 4*HS8;
H_Fusion[1][3] = 2*HS0 - 2*HS15 - 4*HS16;
H_Fusion[2][3] = 2*HS14 + 2*HS2;
H_Fusion[0][4] = 0;
H_Fusion[1][4] = 0;
H_Fusion[2][4] = 0;
H_Fusion[0][5] = 0;
H_Fusion[1][5] = 0;
H_Fusion[2][5] = 0;
H_Fusion[0][6] = 0;
H_Fusion[1][6] = 0;
H_Fusion[2][6] = 0;
H_Fusion[0][7] = 0;
H_Fusion[1][7] = 0;
H_Fusion[2][7] = 0;
H_Fusion[0][8] = 0;
H_Fusion[1][8] = 0;
H_Fusion[2][8] = 0;
H_Fusion[0][9] = 0;
H_Fusion[1][9] = 0;
H_Fusion[2][9] = 0;
H_Fusion[0][10] = 0;
H_Fusion[1][10] = 0;
H_Fusion[2][10] = 0;
H_Fusion[0][11] = 0;
H_Fusion[1][11] = 0;
H_Fusion[2][11] = 0;
H_Fusion[0][12] = 0;
H_Fusion[1][12] = 0;
H_Fusion[2][12] = 0;
H_Fusion[0][13] = 0;
H_Fusion[1][13] = 0;
H_Fusion[2][13] = 0;
H_Fusion[0][14] = 0;
H_Fusion[1][14] = 0;
H_Fusion[2][14] = 0;
H_Fusion[0][15] = 0;
H_Fusion[1][15] = 0;
H_Fusion[2][15] = 0;
H_Fusion[0][16] = -HS10 - HS9;
H_Fusion[1][16] = -2*HS11 + 2*q_x*q_y;
H_Fusion[2][16] = 2*HS12 + 2*q_x*q_z;
H_Fusion[0][17] = 2*HS11 + 2*q_x*q_y;
H_Fusion[1][17] = -HS10 - HS17;
H_Fusion[2][17] = -2*HS18 + 2*q_y*q_z;
H_Fusion[0][18] = -2*HS12 + 2*q_x*q_z;
H_Fusion[1][18] = 2*HS18 + 2*q_y*q_z;
H_Fusion[2][18] = -HS17 - HS9 + 1;
H_Fusion[0][19] = 1;
H_Fusion[1][19] = 0;
H_Fusion[2][19] = 0;
H_Fusion[0][20] = 0;
H_Fusion[1][20] = 1;
H_Fusion[2][20] = 0;
H_Fusion[0][21] = 0;
H_Fusion[1][21] = 0;
H_Fusion[2][21] = 1;


const float KS0 = q_w*q_z;
const float KS1 = q_x*q_y;
const float KS2 = KS0 + KS1;
const float KS3 = 2*P[0][17];
const float KS4 = mag_d*q_z;
const float KS5 = mag_e*q_y;
const float KS6 = KS4 + KS5;
const float KS7 = 2*P[0][1];
const float KS8 = mag_d*q_y;
const float KS9 = mag_e*q_z;
const float KS10 = KS8 - KS9;
const float KS11 = 2*P[0][0];
const float KS12 = q_w*q_y;
const float KS13 = q_x*q_z;
const float KS14 = KS12 - KS13;
const float KS15 = 2*P[0][18];
const float KS16 = powf(q_y, 2);
const float KS17 = 2*KS16;
const float KS18 = powf(q_z, 2);
const float KS19 = 2*KS18 - 1;
const float KS20 = KS17 + KS19;
const float KS21 = mag_d*q_x;
const float KS22 = mag_e*q_w;
const float KS23 = mag_n*q_z;
const float KS24 = KS21 + KS22 - 2*KS23;
const float KS25 = 2*P[0][3];
const float KS26 = mag_d*q_w;
const float KS27 = mag_e*q_x;
const float KS28 = mag_n*q_y;
const float KS29 = KS26 - KS27 + 2*KS28;
const float KS30 = 2*P[0][2];
const float KS31 = 2*P[16][19];
const float KS32 = 4*P[16][16];
const float KS33 = KS16*KS32;
const float KS34 = KS18*KS32;
const float KS35 = 4*P[16][19];
const float KS36 = powf(q_y, 4);
const float KS37 = powf(q_z, 4);
const float KS38 = powf(q_z, 3);
const float KS39 = 8*KS38;
const float KS40 = KS39*mag_d;
const float KS41 = powf(q_y, 3);
const float KS42 = 8*KS41;
const float KS43 = KS42*mag_e;
const float KS44 = 8*KS28;
const float KS45 = KS44*P[2][16];
const float KS46 = 8*KS23;
const float KS47 = KS46*P[3][16];
const float KS48 = KS39*P[16][17]*q_w;
const float KS49 = 4*KS26;
const float KS50 = 4*KS8;
const float KS51 = 4*KS12;
const float KS52 = KS51*P[16][18];
const float KS53 = 4*KS21;
const float KS54 = 4*KS4;
const float KS55 = 4*KS22;
const float KS56 = 4*KS27;
const float KS57 = 4*KS5;
const float KS58 = 4*KS9;
const float KS59 = 4*KS0;
const float KS60 = KS59*P[16][17];
const float KS61 = 4*KS1;
const float KS62 = 4*KS13;
const float KS63 = 4*P[0][0];
const float KS64 = powf(mag_d, 2);
const float KS65 = KS16*KS64;
const float KS66 = powf(mag_e, 2);
const float KS67 = KS18*KS63;
const float KS68 = powf(q_w, 2);
const float KS69 = 4*P[17][17];
const float KS70 = KS18*KS69;
const float KS71 = powf(q_x, 2);
const float KS72 = KS69*KS71;
const float KS73 = 4*P[18][18];
const float KS74 = KS16*KS73;
const float KS75 = KS71*KS73;
const float KS76 = 4*P[1][1];
const float KS77 = KS64*KS76;
const float KS78 = KS16*KS76;
const float KS79 = 4*P[2][2];
const float KS80 = KS64*KS79;
const float KS81 = KS71*KS79;
const float KS82 = 4*P[3][3];
const float KS83 = KS64*KS71;
const float KS84 = KS68*KS82;
const float KS85 = KS42*P[16][18]*q_w;
const float KS86 = 8*KS18;
const float KS87 = 16*mag_n;
const float KS88 = powf(mag_n, 2);
const float KS89 = 16*KS88;
const float KS90 = KS18*P[3][3];
const float KS91 = KS18*KS87;
const float KS92 = P[1][3]*mag_d;
const float KS93 = P[0][3]*mag_e;
const float KS94 = KS91*KS93;
const float KS95 = KS16*KS87;
const float KS96 = P[1][2]*mag_e;
const float KS97 = 16*KS18;
const float KS98 = mag_n*q_w;
const float KS99 = KS98*P[3][17];
const float KS100 = 16*KS16;
const float KS101 = mag_n*q_x;
const float KS102 = KS101*P[2][17];
const float KS103 = KS97*P[3][18];
const float KS104 = 8*KS16;
const float KS105 = mag_d*mag_e;
const float KS106 = KS105*P[0][1];
const float KS107 = 8*KS68;
const float KS108 = KS105*P[2][3];
const float KS109 = 8*KS21;
const float KS110 = KS109*KS16;
const float KS111 = KS110*P[3][16];
const float KS112 = KS86*P[3][16];
const float KS113 = KS4*P[1][16];
const float KS114 = KS4*P[2][17];
const float KS115 = KS104*KS22;
const float KS116 = KS115*P[1][18];
const float KS117 = KS115*P[3][16];
const float KS118 = 8*KS27;
const float KS119 = KS118*KS16;
const float KS120 = KS86*P[2][16];
const float KS121 = KS120*KS27;
const float KS122 = KS5*P[1][16];
const float KS123 = KS107*P[3][18];
const float KS124 = 8*KS9;
const float KS125 = KS124*P[0][16];
const float KS126 = q_w*q_x;
const float KS127 = KS126*P[17][18];
const float KS128 = KS104*KS127;
const float KS129 = 8*KS64;
const float KS130 = KS126*P[2][3];
const float KS131 = KS0*P[16][17];
const float KS132 = KS104*KS131;
const float KS133 = KS0*P[1][2];
const float KS134 = KS129*KS133;
const float KS135 = KS1*P[0][3];
const float KS136 = KS129*KS135;
const float KS137 = q_y*q_z;
const float KS138 = KS137*P[0][1];
const float KS139 = KS137*P[17][18];
const float KS140 = 8*KS71;
const float KS141 = KS104*KS26;
const float KS142 = KS26*P[1][17];
const float KS143 = KS142*KS86;
const float KS144 = KS120*KS26;
const float KS145 = KS21*KS86;
const float KS146 = KS8*KS86;
const float KS147 = 8*KS8;
const float KS148 = KS147*P[2][18];
const float KS149 = KS147*KS71;
const float KS150 = KS149*P[3][17];
const float KS151 = KS4*P[3][18];
const float KS152 = KS22*P[0][17];
const float KS153 = KS118*P[1][17];
const float KS154 = KS140*KS5;
const float KS155 = KS124*P[2][18];
const float KS156 = KS155*KS71;
const float KS157 = KS124*P[3][17];
const float KS158 = KS127*KS86;
const float KS159 = 8*KS66;
const float KS160 = KS12*KS129;
const float KS161 = KS12*P[16][18];
const float KS162 = KS161*KS86;
const float KS163 = KS12*P[1][3];
const float KS164 = KS159*KS163;
const float KS165 = KS0*P[0][3];
const float KS166 = KS1*P[1][2];
const float KS167 = KS13*P[0][2];
const float KS168 = KS159*KS167;
const float KS169 = KS13*P[1][3];
const float KS170 = KS139*KS140;
const float KS171 = P[0][2]*mag_d;
const float KS172 = KS171*KS95;
const float KS173 = KS98*P[2][18];
const float KS174 = KS137*P[2][3];
const float KS175 = 16*KS4;
const float KS176 = KS175*P[3][3];
const float KS177 = 16*P[2][3];
const float KS178 = KS5*KS98;
const float KS179 = KS0*mag_e;
const float KS180 = KS179*KS87*P[3][3];
const float KS181 = KS1*KS87;
const float KS182 = KS181*mag_e;
const float KS183 = 16*KS23;
const float KS184 = KS5*P[0][2];
const float KS185 = KS0*P[2][17];
const float KS186 = 16*KS28;
const float KS187 = KS1*KS183;
const float KS188 = KS109*KS22;
const float KS189 = 8*KS5;
const float KS190 = KS189*KS26;
const float KS191 = 8*KS0;
const float KS192 = KS105*P[0][2];
const float KS193 = 8*KS1;
const float KS194 = KS189*KS4;
const float KS195 = KS193*KS26;
const float KS196 = KS195*P[3][18];
const float KS197 = KS0*KS109;
const float KS198 = KS197*P[2][18];
const float KS199 = KS0*KS147;
const float KS200 = KS199*P[1][18];
const float KS201 = KS193*KS4;
const float KS202 = KS201*P[0][18];
const float KS203 = KS193*KS22;
const float KS204 = KS0*KS189;
const float KS205 = KS1*KS191;
const float KS206 = KS205*P[18][18];
const float KS207 = 8*KS179;
const float KS208 = KS193*mag_e;
const float KS209 = KS118*KS4;
const float KS210 = KS203*P[3][17];
const float KS211 = KS118*KS185;
const float KS212 = KS0*P[3][18];
const float KS213 = KS204*P[1][17];
const float KS214 = KS1*KS124;
const float KS215 = KS214*P[0][17];
const float KS216 = KS205*P[17][17];
const float KS217 = 16*P[2][2];
const float KS218 = KS217*KS8*KS98;
const float KS219 = P[2][3]*mag_d;
const float KS220 = KS175*KS28;
const float KS221 = KS1*P[16][17];
const float KS222 = KS221*KS86;
const float KS223 = KS101*KS9;
const float KS224 = KS5*P[1][3];
const float KS225 = -KS177*KS223 - KS183*KS224 - KS222 + KS61*P[16][17] + R_MAG;
const float KS226 = KS13*P[16][18];
const float KS227 = KS104*KS226;
const float KS228 = -KS181*KS219 - KS220*P[1][2] - KS227 + KS62*P[16][18];
const float KS229 = 1.0F/(KS0*KS219*KS87 - KS100*KS102 + KS100*KS173 + KS100*KS23*P[3][16] - KS101*KS103 - KS101*KS176 - KS104*KS106 - KS104*KS113 + KS106*KS86 - KS107*KS108 - KS107*KS114 - KS107*KS139 + KS108*KS140 - KS110*P[0][17] - KS111 - KS112*KS21 - KS112*KS22 - KS116 - KS117 + KS118*KS212 - KS119*P[2][16] - KS121 - KS122*KS86 - KS123*KS5 - KS125*KS16 - KS128 - KS129*KS130 - KS129*KS138 + KS129*KS169 + KS130*KS159 - KS132 - KS134 - KS136 + KS138*KS159 + KS140*KS151 + KS141*P[0][18] + KS141*P[2][16] + KS143 + KS144 + KS145*P[1][18] + KS146*P[0][16] + KS148*KS68 + KS150 + KS152*KS86 + KS153*KS16 + KS154*P[2][17] + KS156 + KS157*KS68 + KS158 + KS159*KS165 + KS159*KS166 - KS16*KS35 + KS16*KS72 + KS16*KS86*P[16][16] + KS16*KS89*P[2][2] + KS160*P[0][2] + KS162 + KS164 + KS168 + KS170 + KS172 + 32*KS174*KS88 - KS177*KS178 - KS18*KS35 + KS18*KS75 + KS18*KS77 - KS180 - KS182*P[2][2] - KS183*KS184 - KS185*KS186 + KS186*KS212 - KS187*P[2][18] - KS187*P[3][17] - KS188*P[2][2] + KS188*P[3][3] - KS190*P[0][3] - KS190*P[1][2] - KS191*KS192 - KS192*KS193 - KS194*P[0][0] + KS194*P[1][1] - KS195*P[2][17] - KS196 + KS197*P[3][17] - KS198 - KS199*P[0][17] - KS200 + KS201*P[1][17] - KS202 - KS203*P[2][18] - KS204*P[0][18] - KS206 + KS207*KS92 + KS208*KS92 + KS209*P[0][3] + KS209*P[1][2] + KS210 + KS211 + KS213 + KS214*P[1][18] + KS215 + KS216 + KS218 + KS220*P[0][3] + KS225 + KS228 + KS27*KS86*P[0][18] + KS28*KS97*P[2][16] + KS31 + KS32*KS36 + KS32*KS37 - KS33 - KS34 + KS38*KS87*P[3][16] - KS39*P[0][16]*mag_e - KS39*P[16][18]*q_x - KS40*P[1][16] + KS41*KS87*P[2][16] + KS42*P[0][16]*mag_d - KS42*P[16][17]*q_x - KS43*P[1][16] - KS44*P[2][19] - KS45 - KS46*P[3][19] - KS47 - KS48 - KS49*P[2][16] - KS49*P[2][19] - KS50*P[0][16] - KS50*P[0][19] - KS51*P[18][19] - KS52 + KS53*P[3][16] + KS53*P[3][19] + KS54*P[1][16] + KS54*P[1][19] + KS55*P[3][16] + KS55*P[3][19] + KS56*P[2][16] + KS56*P[2][19] + KS57*P[1][16] + KS57*P[1][19] + KS58*P[0][16] + KS58*P[0][19] + KS59*P[17][19] + KS60 + KS61*P[17][19] + KS62*P[18][19] + KS63*KS65 + KS66*KS67 + KS66*KS78 + KS66*KS81 + KS66*KS84 + KS68*KS70 + KS68*KS74 + KS68*KS80 + KS82*KS83 + KS85 + KS89*KS90 - KS91*KS92 - KS94 - KS95*KS96 - KS97*KS99 + P[16][16] + P[19][19]);
const float KS230 = KS126 + KS137;
const float KS231 = KS101 + KS4;
const float KS232 = -KS23;
const float KS233 = KS21 + KS232;
const float KS234 = KS0 - KS1;
const float KS235 = 2*P[0][16];
const float KS236 = KS26 - 2*KS27 + KS28;
const float KS237 = 2*KS71;
const float KS238 = KS19 + KS237;
const float KS239 = -KS8 + 2*KS9 + KS98;
const float KS240 = 2*P[17][20];
const float KS241 = 4*P[17][20];
const float KS242 = powf(q_x, 4);
const float KS243 = powf(q_x, 3);
const float KS244 = 8*KS243;
const float KS245 = KS244*mag_n;
const float KS246 = KS244*P[17][18]*q_w;
const float KS247 = 4*KS98;
const float KS248 = 4*KS23;
const float KS249 = 4*KS101;
const float KS250 = 4*KS28;
const float KS251 = 4*KS126;
const float KS252 = KS251*P[17][18];
const float KS253 = 4*KS137;
const float KS254 = 16*mag_e;
const float KS255 = 16*KS66;
const float KS256 = KS254*mag_d;
const float KS257 = KS256*KS71*P[0][1];
const float KS258 = KS256*P[2][3];
const float KS259 = KS71*KS87;
const float KS260 = 16*KS71;
const float KS261 = KS22*P[1][18];
const float KS262 = KS171*mag_n;
const float KS263 = KS92*mag_n;
const float KS264 = KS18*KS44;
const float KS265 = KS44*KS71;
const float KS266 = KS264*P[1][17];
const float KS267 = 8*KS88;
const float KS268 = KS130*KS267;
const float KS269 = KS138*KS267;
const float KS270 = KS109*P[1][18];
const float KS271 = KS98*P[0][16];
const float KS272 = KS140*KS173;
const float KS273 = KS140*KS99;
const float KS274 = KS101*KS104;
const float KS275 = KS46*KS71;
const float KS276 = KS16*KS46;
const float KS277 = KS276*P[1][18];
const float KS278 = KS126*P[0][1];
const float KS279 = KS140*KS161;
const float KS280 = KS131*KS140;
const float KS281 = 16*P[1][1];
const float KS282 = KS21*KS22*KS281;
const float KS283 = KS254*KS92;
const float KS284 = KS175*KS27;
const float KS285 = 16*KS27;
const float KS286 = 16*KS1;
const float KS287 = KS286*KS9;
const float KS288 = KS109*KS98;
const float KS289 = KS147*KS98;
const float KS290 = KS191*mag_n;
const float KS291 = P[0][1]*mag_d;
const float KS292 = KS101*KS4;
const float KS293 = 8*KS292;
const float KS294 = KS4*KS44;
const float KS295 = KS193*KS98;
const float KS296 = KS295*P[3][16];
const float KS297 = KS101*KS191;
const float KS298 = KS297*P[2][16];
const float KS299 = KS0*P[1][16];
const float KS300 = KS299*KS44;
const float KS301 = KS1*KS46;
const float KS302 = KS301*P[0][16];
const float KS303 = KS205*P[16][16];
const float KS304 = KS193*mag_n;
const float KS305 = KS101*KS22;
const float KS306 = KS305*P[1][3];
const float KS307 = -KS1*KS283 - KS170 + KS253*P[17][18] - KS284*P[1][2];
const float KS308 = 1.0F/(-KS0*KS283 - KS101*KS123 - KS102*KS86 - KS103*KS5 + KS104*KS151 + KS104*KS263 - KS107*KS113 - KS107*KS226 - KS107*KS263 + KS111 - KS114*KS140 - KS118*P[1][20] - KS122*KS260 - KS124*P[3][20] + KS129*KS167 + KS129*KS174 + KS129*KS278 + KS134 + KS136 - KS140*KS142 + KS140*KS26*P[0][18] + KS140*KS262 - KS143 - KS144 - KS145*P[0][17] + KS146*P[2][18] - KS146*P[3][17] + KS149*P[0][16] - KS150 - KS153 - KS157 - KS158 + KS160*P[1][3] - KS162 - KS163*KS267 + KS165*KS267 + KS166*KS267 - KS167*KS267 + 32*KS169*KS66 - KS176*KS5 - KS18*KS241 - KS18*KS258 + KS18*KS74 + KS18*KS80 + KS180 - KS182*P[1][1] + KS195*P[1][16] + KS196 - KS197*P[0][16] + KS198 - KS199*P[3][16] + KS200 + KS201*P[2][16] + KS202 + KS206 - KS212*KS285 - KS212*KS44 - KS219*KS290 + KS219*KS304 + KS22*KS97*P[3][16] + 16*KS223*P[0][1] + KS225 + KS227 + KS240 - KS241*KS71 + KS242*KS69 + KS243*KS254*P[1][17] - KS244*P[0][17]*mag_d - KS244*P[16][17]*q_y - KS245*P[2][17] - KS246 - KS247*P[3][17] - KS247*P[3][20] - KS248*P[0][17] - KS248*P[0][20] + KS249*P[2][17] + KS249*P[2][20] + KS250*P[1][17] + KS250*P[1][20] + KS251*P[18][20] + KS252 + KS253*P[18][20] + KS254*KS38*P[3][17] + KS255*KS71*P[1][1] + KS255*KS90 - KS257 - KS259*KS96 - KS260*KS261 + KS260*KS9*P[3][17] - KS262*KS86 - KS264*P[0][18] - KS265*P[1][17] - KS266 - KS268 - KS269 + KS27*KS97*P[1][17] + KS270*KS68 + KS271*KS86 + KS272 + KS273 + KS274*P[1][16] + KS275*P[0][17] + KS277 + KS279 + KS280 - KS282 - KS284*P[0][3] + KS285*KS299 - KS287*P[1][18] - KS287*P[3][16] - KS288*P[0][3] + KS288*P[1][2] + KS289*P[1][1] - KS289*P[3][3] - KS290*KS291 + KS291*KS304 - KS293*P[0][0] + KS293*P[2][2] - KS294*P[0][3] + KS294*P[1][2] + KS295*P[1][18] - KS296 - KS297*P[0][18] - KS298 - KS300 + KS301*P[2][18] - KS302 - KS303 + 16*KS306 + KS307 + KS33*KS71 + KS34*KS68 + KS37*KS69 + KS39*P[0][17]*mag_n - KS39*P[17][18]*q_y - KS40*P[2][17] + KS45*KS71 + KS47*KS68 + KS48 + KS49*P[1][17] + KS49*P[1][20] + KS50*P[3][17] + KS50*P[3][20] + KS53*P[0][17] + KS53*P[0][20] + KS54*P[2][17] + KS54*P[2][20] - KS59*P[16][20] - KS60 + KS61*P[16][20] + KS63*KS83 + KS65*KS82 + KS67*KS88 + KS68*KS75 + KS68*KS77 - KS70 + KS71*KS86*P[17][17] - KS72 + KS78*KS88 + KS81*KS88 + KS84*KS88 + KS86*KS99 + KS94 + P[17][17] + P[20][20]);
const float KS309 = KS12 + KS13;
const float KS310 = KS101 + KS5;
const float KS311 = KS27 - KS28;
const float KS312 = KS126 - KS137;
const float KS313 = KS17 + KS237 - 1;
const float KS314 = -2*KS8 + KS9 + KS98;
const float KS315 = 2*KS21 + KS22 + KS232;
const float KS316 = 2*P[18][21];
const float KS317 = 4*P[18][21];
const float KS318 = 16*mag_d;
const float KS319 = KS93*mag_n;
const float KS320 = KS96*mag_n;
const float KS321 = 16*P[1][2];
const float KS322 = KS26*KS286;
const float KS323 = KS1*KS175;
const float KS324 = 8*KS178;
const float KS325 = KS207*mag_n;
const float KS326 = KS208*mag_n;
const float KS327 = KS101*KS124;
const float KS328 = 1.0F/(KS1*KS171*KS254 - KS100*KS114 + KS100*KS21*P[1][18] - KS100*KS26*P[2][16] + KS101*KS86*P[1][16] - KS102*KS107 - KS104*KS173 + KS104*KS271 + KS104*KS319 + KS104*KS71*P[18][18] - KS107*KS122 - KS107*KS221 - KS107*KS320 - KS109*P[1][21] - KS113*KS260 + KS116 + KS117 - KS118*KS299 + KS119*P[0][18] + KS12*KS267*P[0][2] + KS121 - KS125*KS71 + KS128 + KS132 - KS133*KS159 + KS133*KS267 - KS135*KS159 + KS135*KS267 + KS140*KS152 + KS140*KS261 - KS140*KS319 + KS142*KS260 - KS147*P[2][21] - KS148 + KS153*KS68 - KS154*P[3][18] - KS155*KS16 - KS156 + KS157*KS16 + KS159*KS174 + KS159*KS278 - KS16*KS258 - KS16*KS317 + KS16*KS63*KS88 + KS16*KS66*KS82 + KS16*KS70 - KS164 + 32*KS166*KS64 - KS168 + KS169*KS267 - KS172 + KS18*KS66*KS79 + KS18*KS76*KS88 - KS181*KS291 + KS184*KS46 + KS185*KS44 - KS203*P[0][16] + KS204*P[2][16] - KS21*KS321*KS98 - KS210 - KS211 - KS213 + KS214*P[3][16] - KS215 - KS216 - KS217*KS4*KS5 + KS217*KS65 - KS218 + KS222 + KS224*KS46 + KS228 + KS242*KS73 + KS243*KS318*P[1][18] + KS244*P[0][18]*mag_e - KS244*P[16][18]*q_z - KS245*P[3][18] + KS246 + KS247*P[2][18] + KS247*P[2][21] + KS248*P[1][18] + KS248*P[1][21] + KS249*P[3][18] + KS249*P[3][21] + KS250*P[0][18] + KS250*P[0][21] - KS251*P[17][21] - KS252 + KS253*P[17][21] + KS257 - KS259*KS92 + KS26*KS321*KS5 + KS260*KS8*P[2][18] - KS265*P[0][18] + KS266 + KS268 + KS269 - KS270 - KS272 - KS273 - KS274*P[3][18] - KS275*P[1][18] + KS276*P[0][17] - KS277 - KS279 - KS280 - KS281*KS292 + KS281*KS83 + KS282 - KS295*P[0][17] + KS296 - KS297*P[1][17] + KS298 + KS300 + KS301*P[3][17] + KS302 + KS303 - 8*KS305*P[0][2] - 8*KS306 + KS307 + KS316 - KS317*KS71 + KS318*KS41*P[2][18] + KS320*KS86 - KS322*P[1][16] + KS322*P[2][17] - KS323*P[1][17] - KS323*P[2][16] - KS324*P[0][1] + KS324*P[2][3] - KS325*P[1][1] + KS325*P[2][2] - KS326*P[0][0] + KS326*P[3][3] - KS327*P[0][1] + KS327*P[2][3] + KS33*KS68 + KS34*KS71 + KS36*KS73 - KS42*P[0][18]*mag_n - KS42*P[17][18]*q_z - KS43*P[3][18] + KS45*KS68 + KS47*KS71 + KS5*KS86*P[2][17] + KS51*P[16][21] + KS52 - KS55*P[1][18] - KS55*P[1][21] - KS56*P[0][18] - KS56*P[0][21] + KS57*P[3][18] + KS57*P[3][21] + KS58*P[2][18] + KS58*P[2][21] + KS62*P[16][21] + KS63*KS66*KS71 + KS66*KS68*KS76 + KS68*KS72 + KS68*KS79*KS88 + KS71*KS82*KS88 - KS74 - KS75 - KS85 + P[18][18] + P[21][21] + R_MAG);
const float KS329 = 2*P[1][17];
const float KS330 = 2*P[1][1];
const float KS331 = 2*P[1][18];
const float KS332 = 2*P[1][3];
const float KS333 = 2*P[1][2];
const float KS334 = 2*P[1][16];
const float KS335 = 2*P[2][17];
const float KS336 = 2*P[2][18];
const float KS337 = 2*P[2][3];
const float KS338 = 2*P[2][2];
const float KS339 = 2*P[2][16];
const float KS340 = 2*P[3][17];
const float KS341 = 2*P[3][18];
const float KS342 = 2*P[3][3];
const float KS343 = 2*P[3][16];
const float KS344 = 2*P[1][4];
const float KS345 = 2*P[4][17];
const float KS346 = 2*P[0][4];
const float KS347 = 2*P[4][18];
const float KS348 = 2*P[3][4];
const float KS349 = 2*P[2][4];
const float KS350 = 2*P[4][16];
const float KS351 = 2*P[1][5];
const float KS352 = 2*P[5][17];
const float KS353 = 2*P[0][5];
const float KS354 = 2*P[5][18];
const float KS355 = 2*P[3][5];
const float KS356 = 2*P[2][5];
const float KS357 = 2*P[5][16];
const float KS358 = 2*P[1][6];
const float KS359 = 2*P[6][17];
const float KS360 = 2*P[0][6];
const float KS361 = 2*P[6][18];
const float KS362 = 2*P[3][6];
const float KS363 = 2*P[2][6];
const float KS364 = 2*P[6][16];
const float KS365 = 2*P[1][7];
const float KS366 = 2*P[7][17];
const float KS367 = 2*P[0][7];
const float KS368 = 2*P[7][18];
const float KS369 = 2*P[3][7];
const float KS370 = 2*P[2][7];
const float KS371 = 2*P[7][16];
const float KS372 = 2*P[1][8];
const float KS373 = 2*P[8][17];
const float KS374 = 2*P[0][8];
const float KS375 = 2*P[8][18];
const float KS376 = 2*P[3][8];
const float KS377 = 2*P[2][8];
const float KS378 = 2*P[8][16];
const float KS379 = 2*P[1][9];
const float KS380 = 2*P[9][17];
const float KS381 = 2*P[0][9];
const float KS382 = 2*P[9][18];
const float KS383 = 2*P[3][9];
const float KS384 = 2*P[2][9];
const float KS385 = 2*P[9][16];
const float KS386 = 2*P[10][17];
const float KS387 = 2*P[1][10];
const float KS388 = 2*P[0][10];
const float KS389 = 2*P[10][18];
const float KS390 = 2*P[3][10];
const float KS391 = 2*P[2][10];
const float KS392 = 2*P[10][16];
const float KS393 = 2*P[11][17];
const float KS394 = 2*P[1][11];
const float KS395 = 2*P[0][11];
const float KS396 = 2*P[11][18];
const float KS397 = 2*P[3][11];
const float KS398 = 2*P[2][11];
const float KS399 = 2*P[11][16];
const float KS400 = 2*P[12][17];
const float KS401 = 2*P[1][12];
const float KS402 = 2*P[0][12];
const float KS403 = 2*P[12][18];
const float KS404 = 2*P[3][12];
const float KS405 = 2*P[2][12];
const float KS406 = 2*P[12][16];
const float KS407 = 2*P[13][17];
const float KS408 = 2*P[1][13];
const float KS409 = 2*P[0][13];
const float KS410 = 2*P[13][18];
const float KS411 = 2*P[3][13];
const float KS412 = 2*P[2][13];
const float KS413 = 2*P[13][16];
const float KS414 = 2*P[14][17];
const float KS415 = 2*P[1][14];
const float KS416 = 2*P[0][14];
const float KS417 = 2*P[14][18];
const float KS418 = 2*P[3][14];
const float KS419 = 2*P[2][14];
const float KS420 = 2*P[14][16];
const float KS421 = 2*P[15][17];
const float KS422 = 2*P[1][15];
const float KS423 = 2*P[0][15];
const float KS424 = 2*P[15][18];
const float KS425 = 2*P[3][15];
const float KS426 = 2*P[2][15];
const float KS427 = 2*P[15][16];
const float KS428 = 2*P[16][17];
const float KS429 = 2*P[16][18];
const float KS430 = 2*P[16][16];
const float KS431 = 2*P[17][17];
const float KS432 = 2*P[17][18];
const float KS433 = 2*P[18][18];
const float KS434 = 2*P[17][19];
const float KS435 = 2*P[1][19];
const float KS436 = 2*P[0][19];
const float KS437 = 2*P[18][19];
const float KS438 = 2*P[3][19];
const float KS439 = 2*P[2][19];
const float KS440 = -P[19][21];
const float KS441 = 2*P[1][20];
const float KS442 = 2*P[0][20];
const float KS443 = 2*P[18][20];
const float KS444 = 2*P[3][20];
const float KS445 = 2*P[2][20];
const float KS446 = 2*P[16][20];
const float KS447 = 2*P[17][21];
const float KS448 = 2*P[1][21];
const float KS449 = 2*P[0][21];
const float KS450 = 2*P[3][21];
const float KS451 = 2*P[2][21];
const float KS452 = 2*P[16][21];


K_Fusion[0][0] = -KS229*(KS10*KS11 + KS14*KS15 - KS2*KS3 + KS20*P[0][16] - KS24*KS25 + KS29*KS30 - KS6*KS7 - P[0][19]);
K_Fusion[1][0] = -KS229*(KS10*KS7 + KS14*KS331 - KS2*KS329 + KS20*P[1][16] - KS24*KS332 + KS29*KS333 - KS330*KS6 - P[1][19]);
K_Fusion[2][0] = -KS229*(KS10*KS30 + KS14*KS336 - KS2*KS335 + KS20*P[2][16] - KS24*KS337 + KS29*KS338 - KS333*KS6 - P[2][19]);
K_Fusion[3][0] = -KS229*(KS10*KS25 + KS14*KS341 - KS2*KS340 + KS20*P[3][16] - KS24*KS342 + KS29*KS337 - KS332*KS6 - P[3][19]);
K_Fusion[4][0] = -KS229*(KS10*KS346 + KS14*KS347 - KS2*KS345 + KS20*P[4][16] - KS24*KS348 + KS29*KS349 - KS344*KS6 - P[4][19]);
K_Fusion[5][0] = -KS229*(KS10*KS353 + KS14*KS354 - KS2*KS352 + KS20*P[5][16] - KS24*KS355 + KS29*KS356 - KS351*KS6 - P[5][19]);
K_Fusion[6][0] = -KS229*(KS10*KS360 + KS14*KS361 - KS2*KS359 + KS20*P[6][16] - KS24*KS362 + KS29*KS363 - KS358*KS6 - P[6][19]);
K_Fusion[7][0] = -KS229*(KS10*KS367 + KS14*KS368 - KS2*KS366 + KS20*P[7][16] - KS24*KS369 + KS29*KS370 - KS365*KS6 - P[7][19]);
K_Fusion[8][0] = -KS229*(KS10*KS374 + KS14*KS375 - KS2*KS373 + KS20*P[8][16] - KS24*KS376 + KS29*KS377 - KS372*KS6 - P[8][19]);
K_Fusion[9][0] = -KS229*(KS10*KS381 + KS14*KS382 - KS2*KS380 + KS20*P[9][16] - KS24*KS383 + KS29*KS384 - KS379*KS6 - P[9][19]);
K_Fusion[10][0] = -KS229*(KS10*KS388 + KS14*KS389 - KS2*KS386 + KS20*P[10][16] - KS24*KS390 + KS29*KS391 - KS387*KS6 - P[10][19]);
K_Fusion[11][0] = -KS229*(KS10*KS395 + KS14*KS396 - KS2*KS393 + KS20*P[11][16] - KS24*KS397 + KS29*KS398 - KS394*KS6 - P[11][19]);
K_Fusion[12][0] = -KS229*(KS10*KS402 + KS14*KS403 - KS2*KS400 + KS20*P[12][16] - KS24*KS404 + KS29*KS405 - KS401*KS6 - P[12][19]);
K_Fusion[13][0] = -KS229*(KS10*KS409 + KS14*KS410 - KS2*KS407 + KS20*P[13][16] - KS24*KS411 + KS29*KS412 - KS408*KS6 - P[13][19]);
K_Fusion[14][0] = -KS229*(KS10*KS416 + KS14*KS417 - KS2*KS414 + KS20*P[14][16] - KS24*KS418 + KS29*KS419 - KS415*KS6 - P[14][19]);
K_Fusion[15][0] = -KS229*(KS10*KS423 + KS14*KS424 - KS2*KS421 + KS20*P[15][16] - KS24*KS425 + KS29*KS426 - KS422*KS6 - P[15][19]);
K_Fusion[16][0] = -KS229*(KS10*KS235 + KS14*KS429 - KS2*KS428 + KS20*P[16][16] - KS24*KS343 + KS29*KS339 - KS334*KS6 - P[16][19]);
K_Fusion[17][0] = -KS229*(KS10*KS3 + KS14*KS432 - KS2*KS431 + KS20*P[16][17] - KS24*KS340 + KS29*KS335 - KS329*KS6 - P[17][19]);
K_Fusion[18][0] = -KS229*(KS10*KS15 + KS14*KS433 - KS2*KS432 + KS20*P[16][18] - KS24*KS341 + KS29*KS336 - KS331*KS6 - P[18][19]);
K_Fusion[19][0] = -KS229*(KS10*KS436 + KS14*KS437 - KS2*KS434 + KS20*P[16][19] - KS24*KS438 + KS29*KS439 - KS435*KS6 - P[19][19]);
K_Fusion[20][0] = -KS229*(KS10*KS442 + KS14*KS443 - KS2*KS240 + KS20*P[16][20] - KS24*KS444 + KS29*KS445 - KS441*KS6 - P[19][20]);
K_Fusion[21][0] = -KS229*(KS10*KS449 + KS14*KS316 - KS2*KS447 + KS20*P[16][21] - KS24*KS450 + KS29*KS451 + KS440 - KS448*KS6);
K_Fusion[0][1] = KS308*(KS11*KS233 + KS15*KS230 + KS231*KS30 - KS234*KS235 + KS236*KS7 - KS238*P[0][17] - KS239*KS25 + P[0][20]);
K_Fusion[1][1] = KS308*(KS230*KS331 + KS231*KS333 + KS233*KS7 - KS234*KS334 + KS236*KS330 - KS238*P[1][17] - KS239*KS332 + P[1][20]);
K_Fusion[2][1] = KS308*(KS230*KS336 + KS231*KS338 + KS233*KS30 - KS234*KS339 + KS236*KS333 - KS238*P[2][17] - KS239*KS337 + P[2][20]);
K_Fusion[3][1] = KS308*(KS230*KS341 + KS231*KS337 + KS233*KS25 - KS234*KS343 + KS236*KS332 - KS238*P[3][17] - KS239*KS342 + P[3][20]);
K_Fusion[4][1] = KS308*(KS230*KS347 + KS231*KS349 + KS233*KS346 - KS234*KS350 + KS236*KS344 - KS238*P[4][17] - KS239*KS348 + P[4][20]);
K_Fusion[5][1] = KS308*(KS230*KS354 + KS231*KS356 + KS233*KS353 - KS234*KS357 + KS236*KS351 - KS238*P[5][17] - KS239*KS355 + P[5][20]);
K_Fusion[6][1] = KS308*(KS230*KS361 + KS231*KS363 + KS233*KS360 - KS234*KS364 + KS236*KS358 - KS238*P[6][17] - KS239*KS362 + P[6][20]);
K_Fusion[7][1] = KS308*(KS230*KS368 + KS231*KS370 + KS233*KS367 - KS234*KS371 + KS236*KS365 - KS238*P[7][17] - KS239*KS369 + P[7][20]);
K_Fusion[8][1] = KS308*(KS230*KS375 + KS231*KS377 + KS233*KS374 - KS234*KS378 + KS236*KS372 - KS238*P[8][17] - KS239*KS376 + P[8][20]);
K_Fusion[9][1] = KS308*(KS230*KS382 + KS231*KS384 + KS233*KS381 - KS234*KS385 + KS236*KS379 - KS238*P[9][17] - KS239*KS383 + P[9][20]);
K_Fusion[10][1] = KS308*(KS230*KS389 + KS231*KS391 + KS233*KS388 - KS234*KS392 + KS236*KS387 - KS238*P[10][17] - KS239*KS390 + P[10][20]);
K_Fusion[11][1] = KS308*(KS230*KS396 + KS231*KS398 + KS233*KS395 - KS234*KS399 + KS236*KS394 - KS238*P[11][17] - KS239*KS397 + P[11][20]);
K_Fusion[12][1] = KS308*(KS230*KS403 + KS231*KS405 + KS233*KS402 - KS234*KS406 + KS236*KS401 - KS238*P[12][17] - KS239*KS404 + P[12][20]);
K_Fusion[13][1] = KS308*(KS230*KS410 + KS231*KS412 + KS233*KS409 - KS234*KS413 + KS236*KS408 - KS238*P[13][17] - KS239*KS411 + P[13][20]);
K_Fusion[14][1] = KS308*(KS230*KS417 + KS231*KS419 + KS233*KS416 - KS234*KS420 + KS236*KS415 - KS238*P[14][17] - KS239*KS418 + P[14][20]);
K_Fusion[15][1] = KS308*(KS230*KS424 + KS231*KS426 + KS233*KS423 - KS234*KS427 + KS236*KS422 - KS238*P[15][17] - KS239*KS425 + P[15][20]);
K_Fusion[16][1] = KS308*(KS230*KS429 + KS231*KS339 + KS233*KS235 - KS234*KS430 + KS236*KS334 - KS238*P[16][17] - KS239*KS343 + P[16][20]);
K_Fusion[17][1] = KS308*(KS230*KS432 + KS231*KS335 + KS233*KS3 - KS234*KS428 + KS236*KS329 - KS238*P[17][17] - KS239*KS340 + P[17][20]);
K_Fusion[18][1] = KS308*(KS15*KS233 + KS230*KS433 + KS231*KS336 - KS234*KS429 + KS236*KS331 - KS238*P[17][18] - KS239*KS341 + P[18][20]);
K_Fusion[19][1] = KS308*(KS230*KS437 + KS231*KS439 + KS233*KS436 - KS234*KS31 + KS236*KS435 - KS238*P[17][19] - KS239*KS438 + P[19][20]);
K_Fusion[20][1] = KS308*(KS230*KS443 + KS231*KS445 + KS233*KS442 - KS234*KS446 + KS236*KS441 - KS238*P[17][20] - KS239*KS444 + P[20][20]);
K_Fusion[21][1] = KS308*(KS230*KS316 + KS231*KS451 + KS233*KS449 - KS234*KS452 + KS236*KS448 - KS238*P[17][21] - KS239*KS450 + P[20][21]);
K_Fusion[0][2] = -KS328*(KS11*KS311 - KS235*KS309 - KS25*KS310 + KS3*KS312 - KS30*KS314 + KS313*P[0][18] + KS315*KS7 - P[0][21]);
K_Fusion[1][2] = -KS328*(-KS309*KS334 - KS310*KS332 + KS311*KS7 + KS312*KS329 + KS313*P[1][18] - KS314*KS333 + KS315*KS330 - P[1][21]);
K_Fusion[2][2] = -KS328*(KS30*KS311 - KS309*KS339 - KS310*KS337 + KS312*KS335 + KS313*P[2][18] - KS314*KS338 + KS315*KS333 - P[2][21]);
K_Fusion[3][2] = -KS328*(KS25*KS311 - KS309*KS343 - KS310*KS342 + KS312*KS340 + KS313*P[3][18] - KS314*KS337 + KS315*KS332 - P[3][21]);
K_Fusion[4][2] = -KS328*(-KS309*KS350 - KS310*KS348 + KS311*KS346 + KS312*KS345 + KS313*P[4][18] - KS314*KS349 + KS315*KS344 - P[4][21]);
K_Fusion[5][2] = -KS328*(-KS309*KS357 - KS310*KS355 + KS311*KS353 + KS312*KS352 + KS313*P[5][18] - KS314*KS356 + KS315*KS351 - P[5][21]);
K_Fusion[6][2] = -KS328*(-KS309*KS364 - KS310*KS362 + KS311*KS360 + KS312*KS359 + KS313*P[6][18] - KS314*KS363 + KS315*KS358 - P[6][21]);
K_Fusion[7][2] = -KS328*(-KS309*KS371 - KS310*KS369 + KS311*KS367 + KS312*KS366 + KS313*P[7][18] - KS314*KS370 + KS315*KS365 - P[7][21]);
K_Fusion[8][2] = -KS328*(-KS309*KS378 - KS310*KS376 + KS311*KS374 + KS312*KS373 + KS313*P[8][18] - KS314*KS377 + KS315*KS372 - P[8][21]);
K_Fusion[9][2] = -KS328*(-KS309*KS385 - KS310*KS383 + KS311*KS381 + KS312*KS380 + KS313*P[9][18] - KS314*KS384 + KS315*KS379 - P[9][21]);
K_Fusion[10][2] = -KS328*(-KS309*KS392 - KS310*KS390 + KS311*KS388 + KS312*KS386 + KS313*P[10][18] - KS314*KS391 + KS315*KS387 - P[10][21]);
K_Fusion[11][2] = -KS328*(-KS309*KS399 - KS310*KS397 + KS311*KS395 + KS312*KS393 + KS313*P[11][18] - KS314*KS398 + KS315*KS394 - P[11][21]);
K_Fusion[12][2] = -KS328*(-KS309*KS406 - KS310*KS404 + KS311*KS402 + KS312*KS400 + KS313*P[12][18] - KS314*KS405 + KS315*KS401 - P[12][21]);
K_Fusion[13][2] = -KS328*(-KS309*KS413 - KS310*KS411 + KS311*KS409 + KS312*KS407 + KS313*P[13][18] - KS314*KS412 + KS315*KS408 - P[13][21]);
K_Fusion[14][2] = -KS328*(-KS309*KS420 - KS310*KS418 + KS311*KS416 + KS312*KS414 + KS313*P[14][18] - KS314*KS419 + KS315*KS415 - P[14][21]);
K_Fusion[15][2] = -KS328*(-KS309*KS427 - KS310*KS425 + KS311*KS423 + KS312*KS421 + KS313*P[15][18] - KS314*KS426 + KS315*KS422 - P[15][21]);
K_Fusion[16][2] = -KS328*(KS235*KS311 - KS309*KS430 - KS310*KS343 + KS312*KS428 + KS313*P[16][18] - KS314*KS339 + KS315*KS334 - P[16][21]);
K_Fusion[17][2] = -KS328*(KS3*KS311 - KS309*KS428 - KS310*KS340 + KS312*KS431 + KS313*P[17][18] - KS314*KS335 + KS315*KS329 - P[17][21]);
K_Fusion[18][2] = -KS328*(KS15*KS311 - KS309*KS429 - KS310*KS341 + KS312*KS432 + KS313*P[18][18] - KS314*KS336 + KS315*KS331 - P[18][21]);
K_Fusion[19][2] = -KS328*(-KS309*KS31 - KS310*KS438 + KS311*KS436 + KS312*KS434 + KS313*P[18][19] - KS314*KS439 + KS315*KS435 + KS440);
K_Fusion[20][2] = -KS328*(KS240*KS312 - KS309*KS446 - KS310*KS444 + KS311*KS442 + KS313*P[18][20] - KS314*KS445 + KS315*KS441 - P[20][21]);
K_Fusion[21][2] = -KS328*(-KS309*KS452 - KS310*KS450 + KS311*KS449 + KS312*KS447 + KS313*P[18][21] - KS314*KS451 + KS315*KS448 - P[21][21]);


